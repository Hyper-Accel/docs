<!---
Copyright 2024 The HyperAccel Inc. All rights reserved.
-->

### Requirements and Install Guide
Requirements and Install Guide is same as[ vLLM API](./offline_inference.md). 


## OpenAI Compatible Server

### Serving Model

hyperdex-vllm also provides an HTTP server that implements OpenAI's Completions API. You can call the server by the command below.
```shell linenums="1"
NUM_LPU_DEVICES=2 vllm </path/to/llama-7b>

... OMISSION ...

INFO:     Started server process [11801]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

### Openai Client

To call the server, you can use OpenAI Python client library, or any other HTTP client. Change stream option if you want.

```shell linenums="1"
curl http://localhost:8000/v1/chat/completions   -H "Content-Type: application/json"   -H "Authorization: Bearer EMPTY"   -d '{
    "model": "TinyLlama/TinyLlama-1.1B-Chat-v1.0",
    "messages": [
      {"role": "system", "content": "You are a helpful assistant."},
      {"role": "user", "content": "Who won the world series in 2020?"},
      {"role": "assistant", "content": "The Los Angeles Dodgers won the ^Crld Series in 2020."},
      {"role": "user", "content": "Where was it played?"}
    ]
  }'
```
example results
```shell linenums="1"

Chat completion results:
{"id":"chatcmpl-c81bcb28a96d4fdcbf84635b48b747bb","object":"chat.completion","created":1756111835,"model":"TinyLlama/TinyLlama-1.1B-Chat-v1.0","choices":[{"index":0,"message":{"role":"assistant","reasoning_content":null,"content":"The World Series was played at Dodger Stadium in Los Angeles, California. The series was the first one in 10 years to be played in Los Angeles, and it was also played a different time of year due to the COVID-19 pandemic.","tool_calls":[]},"logprobs":null,"finish_reason":"stop","stop_reason":null}],"usage":{"prompt_tokens":84,"total_tokens":139,"completion_tokens":55,"prompt_tokens_details":null},"prompt_logprobs":null,"kv_transfer_params":null}
```
